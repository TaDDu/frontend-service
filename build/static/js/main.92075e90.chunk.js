(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,a){e.exports=a(50)},27:function(e,t,a){},29:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},30:function(e,t,a){},50:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=a(16),r=a.n(s),l=a(53),c=(a(27),a(4)),i=a(5),m=a(10),u=a(9),d=a(11),h=a(2),g=(a(29),a(30),a(54)),p=a(55),f=a(52),E=function(){function e(t,a){Object(c.a)(this,e),this._url=t,this._header=a,this._header["Content-Type"]="application/json"}return Object(i.a)(e,[{key:"me",value:function(){var e=this._url,t=this._header;return new Promise(function(a,n){fetch(e+"me",{method:"get",headers:t}).then(function(e){return e.json()}).then(function(e){a(e)})})}}]),e}(),b=a(51),v=a(19),N=a.n(v),S=function(){function e(){Object(c.a)(this,e)}return Object(i.a)(e,[{key:"google",value:function(e){return new Promise(function(t,a){fetch(document.location.origin+"/api/login/googleauth",{method:"post",headers:{"Content-Type":" application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){t(e)})})}}]),e}(),O=function(e){function t(e){var a;return Object(c.a)(this,t),a=Object(m.a)(this,Object(u.a)(t).call(this,e)),console.log("LOGIN",e),a.state={use:{},authenticated:!1,handleToUpdate:a.props.handleToUpdate,loggedin:!1,username:"",password:"",redirect:!1,session:{},user:{},header:{}},console.log(a.state),a.logIn=a.logIn.bind(Object(h.a)(Object(h.a)(a))),a.authUser=a.authUser.bind(Object(h.a)(Object(h.a)(a))),a.handleChange=a.handleChange.bind(Object(h.a)(Object(h.a)(a))),a.responseGoogle=a.responseGoogle.bind(Object(h.a)(Object(h.a)(a))),a.loginService=new S,a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){console.log(this.state),"inputEmail"===e.target.id&&this.setState({username:e.target.value}),"inputPassword"===e.target.id&&this.setState({password:e.target.value})}},{key:"logIn",value:function(e){var t=this;e.preventDefault(),console.log(this.state),this.authUser(this.state.username,this.state.password).then(function(e){console.log("SUCCESSSSSSS",e),sessionStorage.setItem("authenticated",!0),sessionStorage.setItem("apikey",e.jwt),console.log("SET REDIRECT"),t.setState({redirect:!0})})}},{key:"authUser",value:function(e,t){return new Promise(function(a,n){var o=window.location.origin+"/api/login",s={email:e,password:t};s=JSON.stringify(s),fetch(o,{method:"post",headers:{"Content-Type":"application/json"},body:s}).then(function(e){return e.json()}).then(function(e){a(e)})})}},{key:"responseGoogle",value:function(e){var t=this;if(console.log("Got response from google"),e.error)console.log("error from google",e);else{var a={pic:e.profileObj.imageUrl,firstName:e.profileObj.givenName,lastName:e.profileObj.familyName,email:e.profileObj.email,googleId:e.profileObj.googleId,accessToken:e.accessToken};this.loginService.google(a).then(function(e){console.log("authenticated to api server"),console.log("SUCCESSSSSSS",e),sessionStorage.setItem("authenticated",!0),sessionStorage.setItem("apikey",e.jwt),console.log("SET REDIRECT"),t.setState({redirect:!0})})}}},{key:"render",value:function(){var e={from:{pathname:this.props.props.history.location.pathname||"/"}},t=this.state.redirect;return console.log("FROM",e),t?o.a.createElement(f.a,{to:e}):o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-9 col-md-7 col-lg-5 mx-auto"},o.a.createElement("div",{className:"card card-signin my-5"},o.a.createElement("div",{className:"card-body"},o.a.createElement("h5",{className:"card-title text-center"},"Sign In"),o.a.createElement("form",{className:"form-signin",onSubmit:this.logIn},o.a.createElement("div",{className:"form-label-group"},o.a.createElement("input",{type:"email",id:"inputEmail",className:"form-control",placeholder:"Email address",value:this.state.username,onChange:this.handleChange,required:!0,autoFocus:!0}),o.a.createElement("label",{htmlFor:"inputEmail"},"Email address")),o.a.createElement("div",{className:"form-label-group"},o.a.createElement("input",{type:"password",id:"inputPassword",className:"form-control",placeholder:"Password",value:this.state.password,onChange:this.handleChange,required:!0}),o.a.createElement("label",{htmlFor:"inputPassword"},"Password")),o.a.createElement("div",{className:"custom-control custom-checkbox mb-3"},o.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"customCheck1"}),o.a.createElement("label",{className:"custom-control-label",htmlFor:"customCheck1"},"Remember password")),o.a.createElement("button",{className:"btn btn-lg btn-primary btn-block text-uppercase",type:"submit"},"Sign in"),o.a.createElement("hr",{className:"my-4"}),o.a.createElement(b.a,{to:"/register",className:"btn btn-lg btn-primary btn-block text-uppercase"},"Register"),o.a.createElement(N.a,{clientId:"975467020281-d513ujk0t5s6qgavpqsevmuf6l0qjpbp.apps.googleusercontent.com",buttonText:"Sign in with Google",onSuccess:this.responseGoogle,onFailure:this.responseGoogle}))))))}}]),t}(n.Component),y=function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-9 col-md-7 col-lg-5 mx-auto"},o.a.createElement("div",{className:"card card-signin my-5"},o.a.createElement("div",{className:"card-body"},o.a.createElement("h5",{className:"card-title text-center"},"Sign In"),o.a.createElement("form",{className:"form-signin"},o.a.createElement("div",{className:"form-label-group"},o.a.createElement("input",{type:"email",id:"inputEmail",className:"form-control",placeholder:"Email address",required:!0,autoFocus:!0}),o.a.createElement("label",{htmlFor:"inputEmail"},"Email address")),o.a.createElement("div",{className:"form-label-group"},o.a.createElement("input",{type:"password",id:"inputPassword",className:"form-control",placeholder:"Password",required:!0}),o.a.createElement("label",{htmlFor:"inputPassword"},"Password")))))))}}]),t}(n.Component),j=a(20),w=function(e){function t(e){var a;return Object(c.a)(this,t),console.log("HEADER LOADED"),a=Object(m.a)(this,Object(u.a)(t).call(this,e)),console.log(e),a.state={},a.changeMenu=a.changeMenu.bind(Object(h.a)(Object(h.a)(a))),a.handleStateChange=a.handleStateChange.bind(Object(h.a)(Object(h.a)(a))),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"changeMenu",value:function(){console.log("CLICK"),this.setState({areMenusOpen:!this.state.areMenusOpen})}},{key:"handleStateChange",value:function(e){console.log(e),this.setState({areMenusOpen:e.isOpen})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement(j.slide,{width:"100%",pageWrapId:"page-wrap",outerContainerId:"outer-container",disableOverlayClick:!0,noOverlay:!0,isOpen:this.state.areMenusOpen,onStateChange:function(t){return e.handleStateChange(t)},itemListClassName:"sidebar-nav",customCrossIcon:o.a.createElement("div",null,o.a.createElement("i",{className:"fa fa-times fa-2x"}))},o.a.createElement("li",{className:"sidebar-brand"},o.a.createElement("i",null,"Welcome")),o.a.createElement("li",{className:"col-12"},o.a.createElement("a",{href:"#",onClick:this.changeMenu,className:"hidden-sm hidden-md hidden-lg"},o.a.createElement("i",{className:"fas fa-home"}," ","Home ",o.a.createElement("span",{className:"sr-only"},"(current)")))),o.a.createElement("li",{className:"col-12"},o.a.createElement(b.a,{to:"/accounts",onClick:this.changeMenu,className:"hidden-sm hidden-md hidden-lg"},o.a.createElement("i",{className:"fas fa-building"}," Accounts "))," ",o.a.createElement("i",{className:"fas fa-caret-square-down text-white","data-toggle":"collapse","data-target":"#fast_form"}),o.a.createElement("div",{id:"fast_form",className:"collapse"})),o.a.createElement("li",{className:"col-12"},o.a.createElement(b.a,{to:"/contacts",onClick:this.changeMenu,className:"hidden-sm hidden-md hidden-lg"},o.a.createElement("i",{className:"fas fa-users"}," Contacts"))),o.a.createElement("li",{className:"col-12"},o.a.createElement(b.a,{to:"/settings",onClick:this.changeMenu,className:"hidden-sm hidden-md hidden-lg"},o.a.createElement("i",{className:"fas fa-cogs"}," Settings")))),o.a.createElement("nav",{className:"navbar navbar-default navbar-fixed-top hidden-xs",style:{backgroundColor:"#34495e"}},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"navbar-header"},o.a.createElement("a",{className:"navbar-brand",href:"#",style:{paddingTop:"5px"}})),o.a.createElement("div",{className:"nav navbar-nav"},o.a.createElement("button",{type:"button",onClick:this.changeMenu,className:"btn navbar-toggle navbar-btn",style:{display:"block"}},o.a.createElement("i",{className:"fa fa-bars",onClick:this.changeMenu,"aria-hidden":"true"}))))))}}]),t}(o.a.Component),k=function(){function e(t,a){Object(c.a)(this,e),this._url=t,this._header=a,this._header["Content-Type"]="application/json"}return Object(i.a)(e,[{key:"me",value:function(){var e=this._url,t=this._header;return new Promise(function(a,n){fetch(e,{method:"get",headers:t}).then(function(e){return e.json()}).then(function(e){a(e)})})}}]),e}(),C=function(e){function t(e){var a;Object(c.a)(this,t),console.log("HOME"),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).state={user:{},location:{city:"loading"}};var n=sessionStorage.getItem("apikey");return a.userService=new E(window.location.origin+"/api/users/",{authorization:"Bearer "+n}),a.ipLocationService=new k(window.location.origin+"/api/ip-location",{authorization:"Bearer "+n}),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){}},{key:"componentWillUnmount",value:function(){console.log("UNMOUNT")}},{key:"componentDidMount",value:function(){var e=this;this.userService.me().then(function(t){e.setState({user:t}),e.ipLocationService.me().then(function(t){null==t.city&&(t.city="No location"),e.setState({location:t})})})}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"d-flex flex-wrap"},o.a.createElement("div",{className:"p-2 flex-fill"},o.a.createElement("div",{className:"card card-default"},o.a.createElement("div",{className:"card-header"},"Profile"),o.a.createElement("div",{className:"card-body"},o.a.createElement("h4",{className:"card-title"},this.state.user.email),o.a.createElement("p",null,"Welcome: ",this.state.user.firstName," ",this.state.user.lastName)))),o.a.createElement("div",{className:"p-2 flex-grow-1"},o.a.createElement("div",{className:"card card-default h-100"},o.a.createElement("div",{className:"card-header"},"Temperature @ ",this.state.location.city),o.a.createElement("div",{className:"card-body text-center"},o.a.createElement("h1",null,"0 "))))))}}]),t}(n.Component),I=function(e){function t(e){var a;Object(c.a)(this,t),a=Object(m.a)(this,Object(u.a)(t).call(this,e)),console.log(e),a.state={authenticated:!1,redirect:!1};a.handleToUpdate.bind(Object(h.a)(Object(h.a)(a)));return a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=sessionStorage.getItem("authenticated");if(console.log("SESSION",t),"true"===t){var a=sessionStorage.getItem("apikey");this.userService=new E(window.location.origin+"/api/users/",{authorization:"Bearer "+a}),this.userService.me().then(function(t){t.error?e.setState({authenticated:!1}):e.setState({authenticated:!0})})}else console.log("Redirect"),this.setState({redirect:!0}),sessionStorage.setItem("authenticated",!1)}},{key:"shouldComponentUpdate",value:function(e,t){return console.log("shouldComponentUpdate",e,t),!0}},{key:"componentDidUpdate",value:function(){console.log("componentDidUpdate",this.state);var e=sessionStorage.getItem("authenticated");console.log("SESSION",e),"true"===e&&!1===this.state.authenticated&&this.setState({authenticated:!0,redirect:!1})}},{key:"handleToUpdate",value:function(e){if(console.log("HANDLEUPDATE",e),e.error)this.setState({error:!0,errorMsg:e.msg});else{console.log("HANDLEUPDATE",e);var t=sessionStorage.getItem("authenticated");console.log("SESSION",t),"true"===t?this.setState({authenticated:!0}):(this.setState({redirect:!0}),sessionStorage.setItem("authenticated",!1))}}},{key:"render",value:function(){var e=this,t=this.state.authenticated;return console.log("isLoggedIn",t),o.a.createElement("div",{id:"outer",className:""},t?o.a.createElement("div",null,o.a.createElement(w,null),o.a.createElement("div",{id:"inner",className:"container"},o.a.createElement(g.a,null,o.a.createElement(p.a,{path:"/home",component:C}),o.a.createElement(f.a,{to:"/home"})))):o.a.createElement("div",{className:"container"},o.a.createElement(g.a,null,o.a.createElement(p.a,{path:"/register",exact:!0,component:y}),o.a.createElement(p.a,{path:"/login",exact:!0,render:function(t){return o.a.createElement(O,{props:t,handleToUpdate:e.handleToUpdate})}}),o.a.createElement(f.a,{to:"/login"}))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(l.a,null,o.a.createElement(I,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[21,2,1]]]);
//# sourceMappingURL=main.92075e90.chunk.js.map